{% extends 'clinic/base_auth.html' %}
{% load static %}
{% block title %}Verify Email - ePetCare{% endblock %}

{% block head %}
<link rel="stylesheet" href="{% static 'clinic/dashboard-common.css' %}?v={% now 'U' %}">
{% endblock %}

{% block content %}
<section class="dash-hero">
  <div class="hero-main">
    <div class="hero-title-row">
      <h1 class="hero-title">Verify Your Email</h1>
    </div>
    <div class="hero-meta-line">
      <span class="meta-item">Enter the verification code sent to {{ email }}</span>
    </div>
  </div>
  <div class="hero-divider"></div>
</section>

<div class="main-card" style="max-width: 500px; margin: 40px auto;">
  <div style="padding: 30px;">
    {% if messages %}
      <div style="margin-bottom: 20px;">
        {% for message in messages %}
          <div class="alert alert-{{ message.tags }}" style="padding: 12px; margin-bottom: 10px; border-radius: 6px; {% if message.tags == 'error' %}background: #fee; color: #c00; border: 1px solid #fcc;{% elif message.tags == 'success' %}background: #efe; color: #0a0; border: 1px solid #cfc;{% else %}background: #eef; color: #007; border: 1px solid #ccf;{% endif %}">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}

    <form method="post">
      {% csrf_token %}

      <div class="form-group">
        <label for="otp">Verification Code:</label>
        <input
          type="text"
          name="otp"
          id="otp"
          class="form-control"
          placeholder="Enter 6-digit code"
          maxlength="6"
          pattern="[0-9]{6}"
          required
          autofocus
          style="font-size: 24px; text-align: center; letter-spacing: 8px; font-family: monospace;"
        >
        <small style="display: block; margin-top: 8px; color: #666;">
          Check your email inbox for the verification code
        </small>
      </div>

      <div class="form-actions" style="margin-top: 30px;">
        <button type="submit" class="btn btn-primary" style="width: 100%;">Verify Code</button>
        <a href="{% url 'profile' %}" class="btn btn-secondary" style="width: 100%; margin-top: 10px;">Cancel</a>
      </div>
    </form>

    <div style="margin-top: 20px; text-align: center;">
      <p style="color: #666; font-size: 14px;">
        Didn't receive the code?
        <a href="{% url 'profile' %}#security" style="color: var(--accent, #E28413);">Request a new one</a>
      </p>
    </div>
  </div>
</div>

<script>
// Auto-submit when 6 digits entered
document.getElementById('otp').addEventListener('input', function(e) {
  if (e.target.value.length === 6 && /^\d{6}$/.test(e.target.value)) {
    e.target.form.submit();
  }
});
</script>
{% endblock %}
